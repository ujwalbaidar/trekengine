<div>
	<h3>Profile</h3>
</div>
<div class="divider"></div>

<div class="row">
	<div class="col s12 m12">
		<div class="card" *ngIf="displayContent==true;else updateContent">
			<div class="card-content">
				<span class="card-title">
					<strong>Profile Details</strong>
				</span>
				<div class="right">
					<a class="btn-floating waves-effect waves-light #80d8ff light-blue accent-1" (click)="displayContent=false">
						<i class="material-icons">edit</i>
					</a>
				</div>
			</div>
			<div *ngIf="profile">
				<div class="card-action">
					<div class="row">
						<div class="col s6">
							<div class="col s12 m3">
								<strong>Name</strong>
							</div>
							<div class="col s12 m9">
								<span>{{profile.firstName}}</span>
								<span *ngIf="profile && profile.middleName">{{' '+profile.middleName}}</span>
								<span>{{' '+profile.lastName}}</span>
							</div>
						</div>
						<div class="col s6">
							<div class="col s12 m3">
								<strong>Email</strong>
							</div>
							<div class="col s12 m9">
								<span>{{profile.email}}</span>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col s6">
							<div class="col s12 m3">
								<strong>Birthday</strong>
							</div>
							<div class="col s12 m9">
								<span>{{profile?.birthday?.formatted}}</span>
							</div>
						</div>
						<div class="col s6">
							<div class="col s12 m3">
								<strong>Gender</strong>
							</div>
							<div class="col s12 m9">
								<span>{{profile?.gender}}</span>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col s6">
							<div class="col s12 m3">
								<strong>Address</strong>
							</div>
							<div class="col s12 m9">
								<span *ngIf="profile && profile.street">{{profile.street}}</span>
								<span *ngIf="profile && profile.city">{{' '+profile.city}}</span>
								<span *ngIf="profile && profile.country">{{' '+profile.country}}</span>
							</div>
						</div>
						<div class="col s6">
							<div class="col s12 m3">
								<strong>Mobile</strong>
							</div>
							<div class="col s12 m9">
								<span>{{profile.mobile}}</span>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col s6">
							<div class="col s12 m3">
								<strong>Telephone</strong>
							</div>
							<div class="col s12 m9">
								<span>{{profile.telephone}}</span>
							</div>
						</div>
					</div>
				</div>
				<div class="card-action">
					<div class="row">
						<div class="col s6">
							<a (click)="showPasswordForm=true">Change Password</a>
						</div>
					</div>
				</div>
				
				<form #passwordForm="ngForm" novalidate *ngIf="showPasswordForm">
					<div class="card-action" *ngIf="showPasswordForm">
						<div class="row">
							<div class="col s4">
								<label for="userPassword" [ngClass]="{'active':(profilePassword.userPassword!=undefined)}">
									New Password
								</label>
								<input 
									id="userPassword" 
									type="password" 
									class="validate" 
									name="userPassword" 
									[ngModel]="profilePassword.userPassword" 
									#userPassword="ngModel" 
									validateEqual="confirmPassword" 
									reverse="true"
									required>
								<div *ngIf="userPassword?.errors?.required && submittedPasswordForm">
									This Field is Required!
								</div>
							</div>
						</div>
						
						<div class="row">
							<div class="col s4">
								<label for="confirmPassword" [ngClass]="{'active':(profilePassword.confirmPassword!=undefined)}">
									Confirm Password
								</label>
								<input 
									id="confirmPassword" 
									type="password" 
									class="validate" 
									name="confirmPassword" 
									[ngModel]="profilePassword.confirmPassword" 
									#confirmPassword="ngModel"
									validateEqual="userPassword" 
									reverse="false"
									required>
	        	
								<div *ngIf="confirmPassword?.errors?.required && submittedPasswordForm">
									This Field is Required!
								</div>
								<div *ngIf="(confirmPassword?.errors?.validateEqual==false) && (confirmPassword.prestine || submittedPasswordForm)">
									Password Missmatch!
								</div>
							</div>
						</div>

						<div class="card-action">
							<div class="row">
								<a class="btn" (click)="submitPasswordInfo('opt-submit', passwordForm.form, profilePassword)">Submit</a>
								<a class="btn" (click)="submitPasswordInfo('opt-cancel', passwordForm.form, profilePassword)">Cancel</a>
							</div>
						</div>
					</div>
				</form>

				<div class="card-action">
					<div class="row">
						<div class="col s6">
							<div class="col s12 m3">
								<strong>Organization Name</strong>
							</div>
							<div class="col s12 m9">
								<span>{{profile.organizationName}}</span>
							</div>
						</div>
						<div class="col s6">
							<div class="col s12 m3">
								<strong>Organization Contact</strong>
							</div>
							<div class="col s12 m9">
								<span>{{profile.organizationContact}}</span>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col s6">
							<div class="col s12 m3">
								<strong>Organization Address</strong>
							</div>
							<div class="col s12 m9">
								<span *ngIf="profile && profile.organizationStreet">{{profile.organizationStreet}}</span>
								<span *ngIf="profile && profile.organizationCity">{{' '+profile.organizationCity}}</span>
								<span *ngIf="profile && profile.organizationCountry">{{' '+profile.organizationCountry}}</span>
							</div>
						</div>
						<div class="col s6">
							<div class="col s12 m3">
								<strong>Organization Email</strong>
							</div>
							<div class="col s12 m9">
								<span>{{profile.organizationEmail}}</span>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col s6">
							<div class="col s12 m3">
								<strong>Organization Domain</strong>
							</div>
							<div class="col s12 m9">
								<span>{{profile.domain.protocol+profile.domain.website}}</span>
							</div>
						</div>
					</div>
				</div>
				<div class="card-action">
					<strong>Notifications Settings</strong>
				</div>
				<div class="card-action">
					<div class="row">
						<section class="example-section">
							<md-slide-toggle
								class="example-margin"
								(change) = toggleDailyNotification(profile.dailyTripNotification)
								[ngModel]="profile.dailyTripNotification"
								[color]="blue"
								[checked]="true">
								Notify Next Day's Trip Notification
							</md-slide-toggle>
						</section>
						<span>Notify Everyday about next day's trip through email</span>
					</div>
					<div class="row">
						<section class="example-section">
							<md-slide-toggle
								class="example-margin"
								(change) = toggleWeeklyNotification(profile.weeklyTripNotification)
								[ngModel]="profile.weeklyTripNotification"
								[color]="primary"
								[checked]="false">
								Notify this week's Trip Notification
							</md-slide-toggle>
						</section>
						<span>Notify Everyday Sunday about this week's trip through email</span>
					</div>
				</div>
			</div>
		</div>
		<ng-template #updateContent>
			<form class="col s12" #profileDetail="ngForm" novalidate>
				<div class="card">
					<div class="card-content">
						<span class="card-title">
							<strong>Update Profile</strong>
						</span>
					</div>
					<div class="card-action">
						<div *ngIf="userInfo">
							<div class="row">
								<div class="col s4">
									<label for="firstName" [ngClass]="{'active':(userInfo.firstName!=undefined)}">First Name</label>
									<input id="firstName" type="text" class="validate" name="firstName" [(ngModel)]="userInfo.firstName" #firstName="ngModel" [value] = "userInfo.firstName" required>
									<div *ngIf="firstName.errors && (firstName.dirty || firstName.touched)"
										class="alert alert-danger">
										<div [hidden]="!firstName.errors.required">
											This Field is Required!
										</div>
									</div>
								</div>
								<div class="col s4">
									<label for="middleName" [ngClass]="{'active':(userInfo.middleName!=undefined)}">Middle Name</label>
									<input id="middleName" type="text" class="validate" name="middleName" [(ngModel)]="userInfo.middleName" #middleName="ngModel" [value] = "userInfo.middleName">
								</div>
								<div class="col s4">
									<label for="lastName" [ngClass]="{'active':(userInfo.lastName!=undefined)}">Last Name</label>
									<input id="lastName" type="text" class="validate" name="lastName" [(ngModel)]="userInfo.lastName" #lastName="ngModel" [value] = "userInfo.lastName" required>
									<div *ngIf="lastName.errors && (lastName.dirty || lastName.touched)"
										class="alert alert-danger">
										<div [hidden]="!lastName.errors.required">
											This Field is Required!
										</div>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col s4">
									<label for="mobile" [ngClass]="{'active':(userInfo.mobile!=undefined)}">Mobile</label>
									<input id="mobile" type="text" class="validate" name="mobile" [(ngModel)]="userInfo.mobile" #mobile="ngModel" [value] = "userInfo.mobile">
								</div>
								<div class="col s4">
									<label for="telephone" [ngClass]="{'active':(userInfo.telephone!=undefined)}">Telephone</label>
									<input id="telephone" type="text" class="validate" name="telephone" [(ngModel)]="userInfo.telephone" #telephone="ngModel" [value] = "userInfo.telephone">
								</div>
							</div>
							<div class="row">
								<div class="col s4">
									<label for="street" [ngClass]="{'active':(userInfo.street!=undefined)}">Street</label>
									<input id="street" type="text" class="validate" name="street" [(ngModel)]="userInfo.street" #street="ngModel" [value] = "userInfo.street">
								</div>
								<div class="col s4">
									<label for="city" [ngClass]="{'active':(userInfo.city!=undefined)}">City</label>
									<input id="city" type="text" class="validate" name="city" [(ngModel)]="userInfo.city" #city="ngModel" [value] = "userInfo.city">
								</div>
								<div class="col s4">
									<label for="country" [ngClass]="{'active':(userInfo.country!=undefined)}">Country</label>
									<input id="country" type="text" class="validate" name="country" [(ngModel)]="userInfo.country" #country="ngModel" [value] = "userInfo.country">
								</div>
							</div>
							<div class="row">
								<div class="col s4">
									<strong>Birthday</strong>
									<my-date-picker id="birthday" class="validate" name="birthday" [(ngModel)]="userInfo.birthday" #birthday="ngModel" [options]="myDatePickerOptions"></my-date-picker>
								</div>
								<div class="col s4">
									<md-select placeholder="Gender" [(ngModel)]="userInfo.gender" name="gender">
										<md-option *ngFor="let gender of genders" [value]="gender.value">
											{{gender.viewValue}}
										</md-option>
									</md-select>
								</div>
								<div class="col s4">
									<label for="domain" [ngClass]="{'active':(userInfo.domain!=undefined)}">
										Site Domain
									</label>
									<input id="domain" type="text" class="validate" name="domain" [(ngModel)]="userInfo.domain" #domain="ngModel" [value] = "userInfo.domain">
								</div>
							</div>
							<div class="row">
								<div class="col s4">
									<label for="organizationName" [ngClass]="{'active':(userInfo.organizationName!=undefined)}">
										Organization Name
									</label>
									<input id="organizationName" type="text" class="validate" name="organizationName" [(ngModel)]="userInfo.organizationName" #organizationName="ngModel" [value] = "userInfo.organizationName">
								</div>
								<div class="col s4">
									<label for="organizationContact" [ngClass]="{'active':(userInfo.organizationContact!=undefined)}">
										Organization Contact
									</label>
									<input id="organizationContact" type="text" class="validate" name="organizationContact" [(ngModel)]="userInfo.organizationContact" #organizationContact="ngModel" [value] = "userInfo.organizationContact">
								</div>
								<div class="col s4">
									<label for="organizationEmail" [ngClass]="{'active':(userInfo.organizationEmail!=undefined)}">
										Organization Email
									</label>
									<input id="organizationEmail" type="text" class="validate" name="organizationEmail" [(ngModel)]="userInfo.organizationEmail" #organizationEmail="ngModel" [value] = "userInfo.organizationEmail">
								</div>
							</div>
							<div class="row">
								<div class="col s4">
									<label for="organizationStreet" [ngClass]="{'active':(userInfo.organizationStreet!=undefined)}">
										Organization Street
									</label>
									<input id="organizationStreet" type="text" class="validate" name="organizationStreet" [(ngModel)]="userInfo.organizationStreet" #organizationStreet="ngModel" [value] = "userInfo.organizationStreet">
								</div>
								<div class="col s4">
									<label for="organizationCity" [ngClass]="{'active':(userInfo.organizationCity!=undefined)}">
										Organization City
									</label>
									<input id="organizationCity" type="text" class="validate" name="organizationCity" [(ngModel)]="userInfo.organizationCity" #organizationCity="ngModel" [value] = "userInfo.organizationCity">
								</div>
								<div class="col s4">
									<label for="organizationCountry" [ngClass]="{'active':(userInfo.organizationCountry!=undefined)}">
										Organization Country
									</label>
									<input id="organizationCountry" type="text" class="validate" name="organizationCountry" [(ngModel)]="userInfo.organizationCountry" #organizationCountry="ngModel" [value] = "userInfo.organizationCountry">
								</div>
							</div>
						</div>
					</div>
					<div class="card-action">
						<a class="btn" (click)="submitProfileInfo('opt-submit', profileDetail.form)">Submit</a>
						<a class="btn" (click)="submitProfileInfo('opt-cancel', profileDetail.form)">Cancel</a>
					</div>
				</div>
			</form>
		</ng-template>
	</div>
</div>


